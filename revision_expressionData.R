setDir <- "/media/electron"
setDir <- ""

all_mrna_data <-get(load(file.path(setDir,
                                   "/mnt/ndata/Yuanlong/1.Projects/2.PROFILE/1.Data/exp_CELL_LINEs/exp_info.Rdata")))

all_ds <-  c(
  "LI_40kb"="Compendium_LI",
  "GSE105381_HepG2_40kb"="mega_GSE105381_HepG2",
  "LG1_40kb" ="Compendium_LG1",
  "ENCSR444WCZ_A549_40kb"="mega_ENCSR444WCZ_A549",
  "LG2_40kb"="Compendium_LG2",
  "ENCSR489OCU_NCI-H460_40kb"="mega_ENCSR489OCU_NCI-H460",
  "GSE118514_RWPE1_40kb"="mega_GSE118514_RWPE1",
  "ENCSR346DCU_LNCaP_40kb"="mega_ENCSR346DCU_LNCaP",
  "GSE118514_22Rv1_40kb"="GSE118514_22Rv1"
)

final_dt_file <- file.path("CREATE_FINAL_TABLE/all_result_dt.Rdata")
stopifnot(file.exists(final_dt_file))
final_dt <- get(load(final_table_file))
final_dt$regionID <- file.path(final_dt$hicds, final_dt$exprds, final_dt$region)
final_dt$signif_lab <- ifelse(final_dt$adjPvalComb <= 0.01, "signif.", "not signif.")

# > sub_data2=x[["mega_GSE105318_DLD1"]]
# > str(sub_data2)
# List of 2
# $ rep1:Classes ‘data.table’ and 'data.frame':  54849 obs. of  9 variables:
#   ..$ ensembl_gene_id   : chr [1:54849] "ENSG00000000419" "ENSG00000000457" "ENSG00000000460" "ENSG00000000938" ...
# ..$ TPM               : num [1:54849] 79.87 2.28 17.89 0 0.17 ...
# ..$ FPKM              : num [1:54849] 70.91 2.03 15.88 0 0.15 ...
# ..$ expected_count    : num [1:54849] 499 81.7 256.3 0 2 ...
# ..$ external_gene_name: chr [1:54849] "DPM1" "SCYL3" "C1orf112" "FGR" ...
# ..$ chromosome_name   : num [1:54849] 20 1 1 1 1 6 6 6 1 1 ...
# ..$ start_position    : int [1:54849] 49551404 169818772 169631245 27938575 196621008 143815948 53362139 41040684 24683489 24742284 ...
# ..$ end_position      : int [1:54849] 49575092 169863408 169823221 27961788 196716634 143832827 53481768 41067715 24743424 24799466 ...
# ..$ gene_biotype      : chr [1:54849] "protein_coding" "protein_coding" "protein_coding" "protein_coding" ...
# ..- attr(*, ".internal.selfref")=<externalptr> 
#   ..- attr(*, "sorted")= chr "ensembl_gene_id"
# $ rep2:Classes ‘data.table’ and 'data.frame':  54849 obs. of  9 variables:
#   ..$ ensembl_gene_id   : chr [1:54849] "ENSG00000000419" "ENSG00000000457" "ENSG00000000460" "ENSG00000000938" ...
# ..$ TPM               : num [1:54849] 88.64 2.61 16.89 0 0.2 ...
# ..$ FPKM              : num [1:54849] 75.12 2.21 14.32 0 0.17 ...
# ..$ expected_count    : num [1:54849] 627 105 279 0 2 ...
# ..$ external_gene_name: chr [1:54849] "DPM1" "SCYL3" "C1orf112" "FGR" ...
# ..$ chromosome_name   : num [1:54849] 20 1 1 1 1 6 6 6 1 1 ...
# ..$ start_position    : int [1:54849] 49551404 169818772 169631245 27938575 196621008 143815948 53362139 41040684 24683489 24742284 ...
# ..$ end_position      : int [1:54849] 49575092 169863408 169823221 27961788 196716634 143832827 53481768 41067715 24743424 24799466 ...
# ..$ gene_biotype      : chr [1:54849] "protein_coding" "protein_coding" "protein_coding" "protein_coding" ...
# ..- attr(*, ".internal.selfref")=<externalptr> 
#   
  
  # -> for each TAD
  # -> how many genes available in the  rna expr
  # -> mean FPKM
  # -> then I can do the same as for norm and tumor
# Danielle prefer TPM, but I use FPKM